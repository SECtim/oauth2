<?xml version="1.0" encoding="US-ASCII"?>
<!--
		This template is for creating an Internet Draft using xml2rfc, which
		is available here: http://xml.resource.org.
	-->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced. 
     An alternate method (rfc include) is described in the references. -->
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY I-D.narten-iana-considerations-rfc2434bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.narten-iana-considerations-rfc2434bis.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!--
		For a complete list and description of processing instructions (PIs),
		please see http://xml.resource.org/authoring/README.html.
	-->
<!--
		Below are generally applicable Processing Instructions (PIs) that most
		I-Ds might want to use. (Here they are set differently than their
		defaults in xml2rfc v1.32)
	-->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!--
		control vertical white space (using these PIs as follows is
		recommended by the RFC Editor)
	-->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="std" docName="draft-lodderstedt-oauth-jwt-introspection-response-00"
     ipr="trust200902">
  <!--
		category values: std, bcp, info, exp, and historic ipr values:
		full3667, noModification3667, noDerivatives3667 you can add the
		attributes updates="NNNN" and obsoletes="NNNN" they will automatically
		be output with "(if approved)"
	-->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!--
			The abbreviated title is used in the page header - it is only
			necessary if the full title is longer than 39 characters
		-->

    <title abbrev="JWT Response">JWT Response for OAuth Token Introspection</title>

    <author fullname="Torsten Lodderstedt" initials="T." role="editor"
            surname="Lodderstedt">
      <organization>YES.com AG</organization>

      <address>
        <email>torsten@lodderstedt.net</email>

        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

<!--
    <author fullname="Marius Scurtescu" initials="M." surname="Scurtescu ">
      <organization>Google</organization>

      <address>
        <email>mscurtescu@google.com</email>
      </address>
    </author>
-->
    <date day="11" month="March" year="2018" />

    <!-- Meta-data Declarations -->

    <area>Security Area</area>

    <workgroup>Open Authentication Protocol</workgroup>

    <!--
			WG name at the upperleft corner of the doc, IETF is fine for
			individual submissions. If this element is not present, the default
			is "Network Working Group", which is used by the RFC Editor as a nod
			to the history of the IETF.
		-->

    <keyword>token introspection</keyword>
    
    <keyword>JWT</keyword>

    <keyword>oauth2</keyword>

    <!--
			Keywords will be incorporated into HTML output files in a meta tag
			but they have no effect on text or nroff output. If you submit your
			draft to the RFC Editor, the keywords will be used for the search
			engine.
		-->

    <abstract>
      <t>This draft proposes an additional JWT-based response type for the 
      OAuth 2.0 Token Introspection endpoint.</t>
    </abstract>
  </front>

  <middle>
    <section anchor="Introduction" title="Introduction">
      <t><xref target="RFC7662">OAuth 2.0 Token Introspection</xref> introduces a 
      mechanisms to query data associated with a certain access token and its
      status at the respective authorization server. This allows deployments
      to implement handle-based access tokens in an interoperable way.</t>
      <t>The introspection endpoint as specified in <xref target="RFC7662">OAuth 
      2.0 Token Introspection</xref> returns the token data as a plain JSON object 
      in "application/json" format.
      However, there are use cases where the resource server needs evidence 
      about the fact the AS minted the access token and is liable for its 
      contents. An example is a resource server using verified person data 
      to create qualified electronic signatures.</t>
      <t>In such use cases, it would be useful to return a signed JWT as 
      introspection response. This draft extends the Introspection Endpoint
      by the capability to return responses as JWTs.</t>
    </section>


    <section anchor="jwt_response" title="JWT Response">
      <t>The introspection endpoint may respond with a JWT in "application/jwt" format.</t>
      <t>This JWT may contain all the members describes in Section 2.2. of 
      <xref target="RFC7662"/>.</t>
      <t>TBD: is the status needed in this format?</t>
    </section>
    
    <section anchor="client_metadata" title="Client Metadata">
      <t>The authorization server determines what format to use for a particular 
      introspection response. The decision can be based on the mechanisms described 
      in this section.</t>
      <t>The proposal is to register resource servers as client and let them determine
      the response format by utilizing new parameters for dynamic client 
      registration.</t>
      <t>The new parameters follow the pattern established by the
      <xref target="OpenID.Registration">OpenID Connect
      Dynamic Client registration</xref> specification for configuring signing and 
      encryption algorithms for the user info endpoint.</t>
      <t>The following parameters are introduced by this specification: 
		<list hangIndent="8" style="hanging">
      	  <t hangText="introspection_response_signed_response_alg"><xref target="RFC7515">JWS</xref> 
      	  <spanx style="verb">alg</spanx> algorithm 
      	  <xref target="RFC7518">JWA</xref> REQUIRED for signing introspection responses. If 
      	  this is specified, the response will be <xref target="RFC7519">JWT</xref> 
      	  serialized, and signed using JWS. The default, 
      	  if omitted, is for the introspection response to return the Claims as a 
      	  UTF-8 encoded JSON object using the application/json content-type
      	  as defined in <xref target="RFC7662"/>.</t>
          <t hangText="introspection_response_encrypted_response_alg"> 
          <xref target="RFC7516">JWE</xref> <spanx style="verb">alg</spanx> algorithm 
          <xref target="RFC7518">JWA</xref> 
          REQUIRED for encrypting introspection responses. 
          If both signing and encryption are requested, the response will be 
          signed then encrypted, with the result being a Nested JWT, as defined in 
          <xref target="RFC7519">JWT</xref>. The default, if omitted, is that no 
          encryption is performed.</t>
          <t hangText="introspection_response_encrypted_response_enc"><xref target="RFC7516">JWE</xref>
          <spanx style="verb">enc</spanx> algorithm <xref target="RFC7518">JWA</xref> REQUIRED for encrypting 
          introspection responses. If 
          <spanx style="verb">introspection_response_encrypted_response_algy</spanx> is specified, the default 
          for this value is A128CBC-HS256. When 
          <spanx style="verb">introspection_response_encrypted_response_enc</spanx> is included, 
          <spanx style="verb">introspection_response_encrypted_response_alg</spanx> MUST also be provided.</t>
        </list>
      </t>
    </section>    
    
    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>We would like to thank ...</t>
    </section>

    <!-- Possibly a 'Contributors' section ... -->

    <section anchor="IANA" title="IANA Considerations">
      <t>TBD</t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>TBD</t>
    </section>
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.2119"?>

      <?rfc include="reference.RFC.2246"?>
      
      <?rfc include="reference.RFC.7519"?>
      
      <?rfc include="reference.RFC.7591"?>

      <?rfc include="reference.RFC.7662"?>
      
      <?rfc include="reference.RFC.7518"?>
      
      <?rfc include="reference.RFC.7515"?>
      <?rfc include="reference.RFC.7516"?>
      
       <reference anchor="OpenID.Registration" target="https://openid.net/specs/openid-connect-registration-1_0.html">
        <front>
          <title>OpenID Connect Dynamic Client Registration 1.0 incorporating errata set 1</title>

		  <author fullname="Nat Sakimura">
            <organization>NRI</organization>
          </author>
          <author fullname="John Bradley">
            <organization>Ping Identity</organization>
          </author>
          <author fullname="Mike Jones">
            <organization>Microsoft</organization>
          </author>
          <date day="8" month="Nov" year="2014"/>
        </front>
      </reference>

    </references>

 <!--   <references title="Informative References">
    </references> -->
  </back>
</rfc>
